[トップページに戻る](README.ja.md)

# [FTKR_ExVariablesChange](FTKR_ExVariablesChange.js) プラグイン

変数の操作を拡張するプラグインです。

ダウンロード: [FTKR_ExVariablesChange.js](https://raw.githubusercontent.com/futokoro/RPGMaker/master/FTKR_ExVariablesChange.js)

## 目次

以下の項目の順でプラグインの使い方を説明します。
1. [概要](#概要)
2. [アイテム・武器・防具の増減時の変更](#アイテム・武器・防具の増減時の変更)
2. [アイテム・スキルの使用時の変更](#アイテム・スキルの使用時の変更)
2. [タグに記述する計算式について](#タグに記述する計算式について)
* [プラグインの更新履歴](#プラグインの更新履歴)
* [ライセンス](#ライセンス)

## 概要

本プラグインを実装することで、以下の状況において変数やスイッチを操作することができます。

1. アイテム、武器、防具の購入（増加）・売却（減少）時
2. アイテム、スキルの使用時(成功時、失敗時)

[FTKR_ItemSelfVariables.js](FTKR_ItemSelfVariables.js)によって作成したセルフ変数も操作できます。

## アイテム・武器・防具の増減時の変更
対象のメモ欄に以降のタグを追記すると、次の状況において、変数・スイッチの変更ができます。

対象：アイテム、武器、防具

### アイテム・武器・防具の購入時
```
<EVC 購入時>
計算式
</EVC 購入時>
```

### アイテム・武器・防具の売却時
```
<EVC 売却時>
計算式
</EVC 売却時>
```

### アイテム・武器・防具の増加時
```
<EVC 増加時>
計算式
</EVC 増加時>
```
購入、イベントで入手、敵から入手などで実行

### アイテム・武器・防具の減少時
```
<EVC 減少時>
計算式
</EVC 減少時>
```
売却、イベントなどで減少すると実行

[目次に戻る](#目次)

## アイテム・スキルの使用時の変更
対象のメモ欄に以降のタグを追記すると、次の状況において、変数・スイッチの変更ができます。

対象：アイテム、スキル、アクター、エネミー、クラス、装備、ステート

なお、タグで設定した変数の計算が行われる順番は以下の通りです。
```
アイテム/スキル ⇒ アクター/エネミー ⇒ クラス ⇒ 装備 ⇒ ステート
```

### アイテム・スキルの使用時
```
<EVC 使用時>
計算式
</EVC 使用時>
```
成功失敗問わずに、常に実行する

### アイテム・スキルの成功時
```
<EVC 使用成功時>
計算式
</EVC 使用成功時>
```
アイテム・スキルの使用に成功すると実行する。

### アイテム・スキルの失敗時
```
<EVC 使用失敗時>
計算式
</EVC 使用失敗時>
```
アイテム・スキルの使用に失敗すると実行する。

### ダメージを与えた時
```
<EVC 与ダメージ時>
計算式
</EVC 与ダメージ時>
```
アイテム・スキルを使用してダメージを与えると実行する。

### ダメージを受けた時
```
<EVC 被ダメージ時>
計算式
</EVC 被ダメージ時>
```
アイテム・スキルの使用してダメージを受けると実行する。

[目次に戻る](#目次)

## タグに記述する計算式について

計算式(eval)は、ダメージ計算式のように、計算式を入力することで、固定値以外の値を使用することができます。以下のコードを使用できます。
* s[x]    - スイッチID x の値を意味します。
* v[x]    - 変数ID x の値を意味します。
* av[x]   - 使用者のセルフ変数ID x の値を意味します。(*1)
* bv[x]   - 対象者のセルフ変数ID x の値を意味します。(*1)
* iv[x]   - アイテムのセルフ変数ID x の値を意味します。(*1)(*2)
* number  - 購入・売却・増減時のアイテム数を意味します。
* result  - スキル・アイテムを使用した結果を参照します。(*3)

(*1) セルフ変数を使用する場合は、[FTKR_ItemSelfVariables.js](FTKR_ItemSelfVariables.js)が必要です。<br>
(*2) アイテムとは、使用したスキルまたはアイテム、購入・売却したアイテムのことです。<br>
(*3) result で取得できる値は以下の通り。<br>
* hpDamage - HPダメージ
* mpDamage - MPダメージ
* hpDamage - TPダメージ
* critical - クリティカルなら true

### 設定例
購入時に変数を操作するためアイテムに以下のノートタグを設定する。

```
<EVC 購入時>
s[1] = true
v[10] = 10
iv[1] += v[5]
iv[2] += number
</EVC 購入時>
```
スイッチID1 を ON にします。<br>
変数ID10 に 10 を代入します。<br>
購入したアイテムのセルフ変数ID1 に 変数ID5 の値を加算します。<br>
購入したアイテムのセルフ変数ID2 に 購入数を加算します。

[目次に戻る](#目次)

## プラグインの更新履歴

| バージョン | 公開日 | 更新内容 |
| --- | --- | --- |
| [ver1.0.4](FTKR_ExVariablesChange.js) | 2017/04/28 | アイテム増減時に例外処理を追加 |
| ver1.0.3 | 2017/04/26 | ダメージ時の変数操作機能を追加<br>アイテム・スキル使用時のタグ適用先を拡張。 |
| ver1.0.2 | 2017/04/25 | 対象者のセルフ変数が正しく反映されない不具合を修正 |
| ver1.0.1 | 2017/04/19 | 不具合修正 |
| ver1.0.0 | 2017/04/18 | 初版公開 |

## ライセンス

本プラグインはMITライセンスのもとで公開しています。

[The MIT License (MIT)](https://opensource.org/licenses/mit-license.php)

#
[目次に戻る](#目次)

[トップページに戻る](README.ja.md)